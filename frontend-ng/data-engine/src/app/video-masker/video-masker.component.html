<div class="video-masker-container">
	<div class="top-bar">
		<input type="text" [(ngModel)]="videoDir" placeholder="Enter video frames directory path"
			[disabled]="isInitialized()">
		<button (click)="initVideo()" [disabled]="isInitialized() || isLoading()">Load Video</button>
	</div>

	<div class="main-area">
		<div class="canvas-container">
			<canvas #canvas (click)="onCanvasClick($event)"></canvas>
		</div>

		<div class="sidebar">
			<div class="section">
				<h3>Objects</h3>
				<div class="object-list">
					<div *ngFor="let obj of objects()" class="object-item"
						[class.selected]="selectedObjectId() === obj.id" (click)="selectedObjectId.set(obj.id)">
						<span class="color-indicator" [style.background-color]="obj.color"></span>
						{{ obj.name }}
					</div>
				</div>
				<div class="button-group">
					<button (click)="addObject()">Add Object</button>
					<button (click)="removeObject()" [disabled]="selectedObjectId() === null">Remove</button>
				</div>
			</div>

			<div class="section">
				<h3>Tools</h3>
				<div class="tool-group">
					<label>
						<input type="radio" name="mode" [value]="'positive'"
							[checked]="interactionMode() === 'positive'" (change)="interactionMode.set('positive')">
						Positive Point
					</label>
					<label>
						<input type="radio" name="mode" [value]="'negative'"
							[checked]="interactionMode() === 'negative'" (change)="interactionMode.set('negative')">
						Negative Point
					</label>
				</div>
			</div>

			<div class="section">
				<h3>Actions</h3>
				<button (click)="propagate()" [disabled]="!isInitialized() || isLoading()">Propagate Masks</button>
				<button (click)="clearMasks()" [disabled]="!isInitialized() || isLoading()">Clear All Masks</button>
				<button (click)="save()" [disabled]="!isInitialized()">Save (Placeholder)</button>
			</div>
		</div>
	</div>

	<div class="bottom-bar" *ngIf="isInitialized()">
		<div class="scrubber">
			<span>Frame: {{ currentFrameIdx() }} / {{ numFrames() - 1 }}</span>
			<input type="range" [min]="0" [max]="numFrames() - 1" [ngModel]="currentFrameIdx()"
				(ngModelChange)="currentFrameIdx.set($event); loadFrame($event)">
		</div>
	</div>

	<div class="loading-overlay" *ngIf="isLoading()">
		<div class="loading-spinner"></div>
		<div class="loading-text">Processing...</div>
	</div>
</div>